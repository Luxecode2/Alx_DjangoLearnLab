{% extends 'base.html' %} {% block title %}Blog Posts{% endblock %} {% block
content %}
<h2>
  {% if current_tag %} Posts Tagged: "{{ current_tag }}" {% elif search_query %}
  Search Results for "{{ search_query }}" {% else %} All Blog Posts {% endif %}
</h2>

{% if current_tag %}
<p><a href="{% url 'blog:post_list' %}">&larr; View All Posts</a></p>
{% endif %} {% for post in posts %}
<article class="post">
  <h3>
    <a href="{% url 'blog:post_detail' pk=post.pk %}">{{ post.title }}</a>
  </h3>
  <p class="post-meta">
    By {{ post.author.username }} on {{ post.created_at|date:"F j, Y" }}
  </p>
  <div class="post-content-snippet">
    {{ post.content|truncatechars:200|safe }}
  </div>
  {% if post.tags.all %}
  <div class="post-tags-list">
    <strong>Tags:</strong>
    {% for tag in post.tags.all %}
    <a href="{% url 'blog:posts_by_tag' tag_slug=tag.slug %}" class="tag-link"
      >{{ tag.name }}</a
    >{% if not forloop.last %}, {% endif %} {% endfor %}
  </div>
  {% endif %}
  <a href="{% url 'blog:post_detail' pk=post.pk %}" class="read-more"
    >Read More &rarr;</a
  >
  {% if user.is_authenticated and user == post.author %}
  <div class="post-actions">
    <a href="{% url 'blog:post_edit' pk=post.pk %}">Edit</a> |
    <a href="{% url 'blog:post_delete' pk=post.pk %}">Delete</a>
  </div>
  {% endif %}
</article>
{% empty %}
<p>No posts yet. Why not <a href="{% url 'blog:new_post' %}">create one</a>?</p>
{% endfor %} {# Optional: Pagination links #} {% if is_paginated %}
<div class="pagination">
  {% if page_obj.has_previous %}
  <a
    href="?page={{ page_obj.previous_page_number }}{% if search_query %}&q={{ search_query }}{% elif current_tag %}&tag_slug={{ current_tag }}{% endif %}"
    >&laquo; Previous</a
  >
  {% endif %}
  <span>
    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
  </span>
  {% if page_obj.has_next %}
  <a
    href="?page={{ page_obj.next_page_number }}{% if search_query %}&q={{ search_query }}{% elif current_tag %}&tag_slug={{ current_tag }}{% endif %}"
    >Next &raquo;</a
  >
  {% endif %}
</div>
{% endif %} {% endblock %}
